<template name="routingBasics">
  <h2> Routing Basics </h2>
  <p>In this lesson, we're going to learn all about Routing. Whenever you type a url into the box at the top of your browser, the website you are trying to access will usually "route" you to some page. <strong>Meteor Week</strong>, for instance, routes you to the lesson based on the part of the url in the brackets: <span class="code">https://week.meteor.com/topics/&lt;current-lesson></span> In <strong>Meteor</strong>, there is a neat third-party package called <strong>Iron Router</strong> that can handle all of the routing for us. You can give it a "layout" template, which usually consists of the navbar at the top of the page and the footer at the bottom of the page. The layout template can then be reused for some or all of our routes. <strong>Iron Router</strong> can also do other cool stuff depending on the data we give it. </p>

  <p> <!-- tutorial to install node/atmosphere? -->
  	Let's start off by downloading <strong>Iron Router</strong>. First, you will need to download <a href="atmospherejs.com"><strong>Meteorite</strong></a>, the unofficial package manager for Meteor. You can do that using node package manager: <span class="code">npm install -g meteorite</span> If you don't have NPM, you can get it <a href="npmjs.org">here</a>. Now we can add <strong>Iron Router</strong> to our project with:
  </p>

  <div class="panel panel-default">
    <div class="panel-body">
    	mrt add iron-router
    </div>
  </div>

  <p>
    We'll learn more about Meteorite in a later lesson; it's a really powerful tool that let's you take advantage of the many amazing packages people have written for Meteor. Okay, let's take a look at our new router. Navigate to your app and open <span class="code">router.js</span>.
  </p>

  <!-- TODO: download link for the example github repo -->

  <!-- TODO: explain basic routing and urls (localhost vs. hosting, etc.)-->

  <div class="panel panel-default">
    <div class="panel-body">
      <h5>lib/router.js</h5>
      // Configuration that applies by default to all routes
      Router.configure({
      &nbsp;&nbsp;// Could be a 404 error page for routes not mapped
      &nbsp;&nbsp;template: 'notFound',
      &nbsp;&nbsp;// Default layout
      &nbsp;&nbsp;layoutTemplate: 'layout'
      });
      // Router.map let's us create all of our routes
      Router.map(function() {

      &nbsp;&nbsp;// This will create a route named 'home'.
      &nbsp;&nbsp;// Navigating to 'localhost:3000/' or 'localhost:3000'
      &nbsp;&nbsp;// will display the template named 'home'.
      &nbsp;&nbsp;this.route('home', {path: '/'})

      &nbsp;&nbsp;// This will create a route named 'about'.
      &nbsp;&nbsp;// Navigating to 'localhost:3000/about' will display
      &nbsp;&nbsp;// the template named 'about'.
      &nbsp;&nbsp;this.route('about');

      <!-- TODO: test this route -->
      &nbsp;&nbsp;// Navigating to 'localhost:3000/messages' will display
      &nbsp;&nbsp;// the template named 'messagesList'. That template will be
      &nbsp;&nbsp;// populated with the result of the data function within the
      &nbsp;&nbsp;// '&#123;{> yield}}' Spacebars helper.
      &nbsp;&nbsp;this.route('messagesList', {
      &nbsp;&nbsp;&nbsp;&nbsp;path: '/messages',
      &nbsp;&nbsp;&nbsp;&nbsp;data: function() { return Messages.find(); }
      &nbsp;&nbsp;});

      &nbsp;&nbsp;// Navigating to 'localhost:3000/messages/263' will display
      &nbsp;&nbsp;// the template named 'messageShow'. That template will be
      &nbsp;&nbsp;// populated with the values from the object with an id of 
      &nbsp;&nbsp;// 263 from the Messages collection within the Spacebars
      &nbsp;&nbsp;// helpers. (i.e. &#123;{title}} will show the message title.)
      &nbsp;&nbsp;this.route('messageShow', { 
      &nbsp;&nbsp;&nbsp;&nbsp;path: '/messages/:_id',
      &nbsp;&nbsp;&nbsp;&nbsp;data: function() { return Messages.findOne(this.params._id); }
      &nbsp;&nbsp;});

      });
    </div>
  </div>

  <div class="panel panel-default">
    <div class="panel-body">
      <h5>main.html</h5>
      <div class="code">
        &lt;body&gt;<br>
        &nbsp;&nbsp;&#123;{> yield}}<br>
        &lt;/body&gt;<br>
        <br>
        &lt;template name="about"><br>
        &nbsp;&nbsp;&lt;h1>About&lt;/h1><br>
        &nbsp;&nbsp;&lt;p><br>
        &nbsp;&nbsp;&nbsp;&nbsp;Click &lt;a href="&#123;{pathFor 'home'}}">here&lt;/a> to go to homepage.<br>
        &nbsp;&nbsp;&lt;/p>
        &lt;/template><br>
        <br>
        &lt;template name="messagesList"><br>
        &nbsp;&nbsp;&lt;a href="&#123;{pathFor 'home'}}">Home&lt;/a><br>
        &nbsp;&nbsp;&lt;h1>Messages&lt;/h1><br>
        <!-- TODO: not sure if this works -->
        &nbsp;&nbsp;&#123;{#each data}}<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&#123;{> messageShow}}<br>
        &nbsp;&nbsp;&#123;{/each}}<br>
        &nbsp;&nbsp;&lt;p><br>
        &lt;/template><br>
        <br>
        &lt;template name="messageShow"><br>
        &nbsp;&nbsp;&lt;a href="&#123;{pathFor 'home'}}">Home&lt;/a><br>
        &nbsp;&nbsp;&lt;h1>Title&lt;/h1><br>
        &nbsp;&nbsp;&lt;h5>User: &#123;{user}}&lt;/h5><br>
        &nbsp;&nbsp;&lt;h5>Recipient: &#123;{recipient}}&lt;/h5><br>
        &nbsp;&nbsp;&lt;p>&#123;{text}}&lt;/p><br>
        &nbsp;&nbsp;&lt;p>&#123;{createdAt}}&lt;/p><br>
        &lt;/template>
      </div>
    </div>
  </div>

  <div class="panel panel-default">
    <div class="panel-body">
      <h5>collections.js</h5>
      <div class="code">
        Messages = new Meteor.Collection(&quot;messages&quot;);<br>
        <br>
        Messages.insert({<br>
        &nbsp;&nbsp;user: "jonyive",<br>
        &nbsp;&nbsp;text: "I have some ideas I want you to see",<br>
        &nbsp;&nbsp;recipient: "IDg",<br>
        &nbsp;&nbsp;createdAt: new Date().getTime()<br>
        });<br>
        <br>
        Messages.insert({<br>
        &nbsp;&nbsp;user: "jonyive",<br>
        &nbsp;&nbsp;text: "Coffee?",<br>
        &nbsp;&nbsp;recipient: "tcook",<br>
        &nbsp;&nbsp;createdAt: new Date().getTime()<br>
        });<br>
        <br>
        Messages.insert({<br>
        &nbsp;&nbsp;user: "tcook",<br>
        &nbsp;&nbsp;text: "3:30?",<br>
        &nbsp;&nbsp;recipient: "jonyive",<br>
        &nbsp;&nbsp;createdAt: new Date().getTime()<br>
        });<br>
        <br>
        Messages.insert({<br>
        &nbsp;&nbsp;user: "jonyive",<br>
        &nbsp;&nbsp;text: "Sounds good",<br>
        &nbsp;&nbsp;recipient: "tcook",<br>
        &nbsp;&nbsp;createdAt: new Date().getTime()<br>
        });
      </div>
    </div>
  </div>

  <!-- TODO: browser view -->

  <p>
    Well, that covers all of the basics of routing in Meteor. To check out more advanced features, check out the <a href="https://github.com/EventedMind/iron-router/blob/dev/DOCS.md">official Iron Router documentation</a> and the <a href="/references/routing">quick reference</a> here on Meteor Week. Congrats! You're well on your way to creating fully featured applications using Meteor. In the next lesson, we'll learn all about subscriptions and publications, which let you easily manage data access and permissions for your users.
  </p>

</template>